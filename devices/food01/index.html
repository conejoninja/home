<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Rabbit food dispenser - Home Automation project</title>
    <meta name="generator" content="Hugo 0.21" />

    
    <meta name="description" content="Home Automation system.">
    
    <link rel="canonical" href="https://conejoninja.github.io/home/devices/food01/">
    
    <meta name="author" content="conejoninja">
    

    <meta property="og:url" content="https://conejoninja.github.io/home/devices/food01/">
    <meta property="og:title" content="Home Automation project">
    <meta property="og:image" content="https://conejoninja.github.io/home/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Home Automation project">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://conejoninja.github.io/home/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://conejoninja.github.io/home/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://conejoninja.github.io/home/fonts/icon.eot');
        src: url('https://conejoninja.github.io/home/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://conejoninja.github.io/home/fonts/icon.woff')
               format('woff'),
             url('https://conejoninja.github.io/home/fonts/icon.ttf')
               format('truetype'),
             url('https://conejoninja.github.io/home/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://conejoninja.github.io/home/stylesheets/application.css">
    <link rel="stylesheet" href="https://conejoninja.github.io/home/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://conejoninja.github.io/home/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://conejoninja.github.io/home/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://conejoninja.github.io/home/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue-grey palette-accent-teal">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Rabbit food dispenser
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/conejoninja" title="@conejoninja on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/conejoninja/home" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://conejoninja.github.io/home/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Home Automation project <span class="version">1.0.0</span></strong>
        
          <br>
          conejoninja/home
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/conejoninja/home/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/conejoninja/home/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Home" href="https://conejoninja.github.io/home/">
	
	Home
</a>



  
</li>



<li>
  
    



<a  title="Devices" href="https://conejoninja.github.io/home/devices/">
	
	Devices
</a>



  
</li>



<li>
  
    



<a  title="Protocol" href="https://conejoninja.github.io/home/protocol/">
	
	Protocol
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/conejoninja" target="_blank" title="@conejoninja on GitHub">
              @conejoninja on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:conejo@conejo.me" title="Email of conejo@conejo.me">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Rabbit food dispenser </h1>

			

<p>IoT enabled rabbit food dispenser, automatic and controllable via Internet.</p>

<p><strong>Github repository:</strong> <a href="https://github.com/conejoninja/home_food">https://github.com/conejoninja/home_food</a></p>

<p><img src="https://conejoninja.github.io/home/images/food0101.jpg" alt="rabbit food dispenser" title="Rabbit food 01" /></p>

<h2 id="idea-and-motivation">Idea and motivation</h2>

<p>The main idea was to be able to feed these two little rascals even when I&rsquo;m not at home. Twice a day, a small quantity at breakfast and a bigger one for dinner (non-spoiled rabbits are supposed to eat timothy during the day when they are not sleeping). I would like to also measure the temperature in case it gets too hot, since rabbits don&rsquo;t do well on hot weather.</p>

<p>The dispenser will wake up each 15 minutes, send the temperature and humidity to a server and check if it&rsquo;s time to feed the monsters. It&rsquo;s as autonomous as possible (it will feed them if it&rsquo;s time, even if there&rsquo;s no internet connection). The dispenser will notify if there&rsquo;s a problem with the temperature and humidity readings or if it&rsquo;s jammed. It could receive a command to dispense extra food even if it&rsquo;s not the time to.</p>

<p><img src="https://conejoninja.github.io/home/images/rabbits.jpg" alt="little rascals" title="Baloo &amp; Moneypenny" /></p>

<h2 id="components">Components</h2>

<ul>
<li>ESP12F (or any other similar board)</li>
<li>DS1307 AT24C32 (DS1307 module with 32K EEPROM)</li>
<li>Temperature &amp; humidity DTH11 sensor (or any DHTXX)</li>
<li>L293B / L293D half-bridge</li>
<li>DC motor (one of those cheap geared yellow motors)</li>
<li>Rotary encoder</li>
<li>DC-DC buck converter with 3.3V output (YL-46, AMS1117 based)</li>
<li>2x 10K ohm resistors</li>
<li>4x 1N4007</li>
<li>3D printed parts from STL files</li>
<li>6V power source</li>
<li>Some wire</li>
</ul>

<h2 id="the-circuit">The circuit</h2>

<p><img src="https://github.com/conejoninja/home_food/raw/master/circuit.png" alt="the circuit" title="The circuit" /></p>

<p>The DC motor and the L293D/L293B are powered by the 6V, any phone charger rated at 5V will work too without any issue, but the motor could definitely use that extra power in case there&rsquo;s a jam in the dispenser. From there, the voltage is converted to 3.3V to feed the ESP12F and the rest of components with a DC-DC cheap converter.</p>

<p>Note: I used a L293B instead of the pictured L293D. I also used a DS1307 module with 32k EEPROM memory from ebay, that works at 3.3v instead of the 5v depicted in the image. The DC motor is different too (see more in the motor section). I couldn&rsquo;t find Fritzing components for them.</p>

<h3 id="connections">Connections</h3>

<p>In case the diagram is not clear enough, here are the connections of the ESP12F.</p>

<table>
<thead>
<tr>
<th>ESP12F pins</th>
<th>Component</th>
</tr>
</thead>

<tbody>
<tr>
<td>RST</td>
<td>ESP12F GPIO16 (to be able to deepsleep)</td>
</tr>

<tr>
<td>ADC</td>
<td>-</td>
</tr>

<tr>
<td>CH_PD / EN</td>
<td>3.3V</td>
</tr>

<tr>
<td>GPIO16</td>
<td>ESP12F RST</td>
</tr>

<tr>
<td>GPIO14</td>
<td>DHT11 data pin</td>
</tr>

<tr>
<td>GPIO12</td>
<td>Rotary encoder pin A</td>
</tr>

<tr>
<td>GPIO13</td>
<td>Rotary encoder pin B</td>
</tr>

<tr>
<td>VCC</td>
<td>3.3V (from DC-DC converter)</td>
</tr>

<tr>
<td>GND</td>
<td>GND</td>
</tr>

<tr>
<td>GPIO15</td>
<td>GND</td>
</tr>

<tr>
<td>GPIO2</td>
<td>L293B IN2</td>
</tr>

<tr>
<td>GPIO0</td>
<td>3.3V</td>
</tr>

<tr>
<td>GPIO4</td>
<td>RTC SDA</td>
</tr>

<tr>
<td>GPIO5</td>
<td>RTC SCL</td>
</tr>

<tr>
<td>RXD</td>
<td>L293B IN1</td>
</tr>

<tr>
<td>TXD</td>
<td>-</td>
</tr>
</tbody>
</table>

<p>Due to the limitations of the ESP12F, the RXD pin is used to drive the motor. This will cause some issues is using the Serial to debug the code (it&rsquo;s always on). I tried using pins GPIO9 and GPIO10 that are usually not in the adapter plate, but there are additional limitation using them, and I couldn&rsquo;t make them work. I added a flag in the code to enable/disable the motor/Serial. You can not use the Serial and the motor at the same time, unless you change the pins.</p>


<div style="position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/4CCGwA13kiI" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" allowfullscreen frameborder="0"></iframe>
 </div>


<p>WORK IN PROGRESS</p>


			<aside class="copyright" role="note">
				
				&copy; 2017 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://conejoninja.github.io/home/devices/" title="Devices">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Devices
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://conejoninja.github.io/home/protocol/" title="Protocol">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Protocol
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/conejoninja.github.io\/home\/';
      var repo_id  = 'conejoninja\/home';
    
    </script>

    <script src="https://conejoninja.github.io/home/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

